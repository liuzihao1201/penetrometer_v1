# 电机控制和贯入仪应用程序

## 项目描述

该项目是一个用于控制电机和贯入仪的应用程序。它提供了一个图形用户界面（GUI），用于实时控制和监控切割电机、贯入电机、接近开关和传感器等设备。系统支持精确的位置控制、速度调节，并能实时显示编码器数据。

## 主要功能

- 切割电机和贯入电机的精确控制
- 实时编码器数据采集和显示
- 图形化显示电机位置和扭矩数据
- 接近开关状态监控
- 多线程处理确保UI响应性
- 自动串口检测和配置

## 文件结构

```
project/
│
├── cut_motor_control/
│   ├── communication.py     # 切割电机Modbus通信
│   └── controller.py        # 切割电机控制逻辑
│
├── penetration_motor_control/
│   ├── communication.py     # 贯入电机通信
│   └── controller.py        # 贯入电机控制逻辑
│
├── proximity_switch/
│   ├── communication.py     # 接近开关通信
│   └── control.py          # 接近开关控制逻辑
│
├── penetrometer_v1_1.py    # 主程序入口
└── gui_v1.py              # GUI界面定义
```

## 系统要求

- Python 3.8+
- Windows/Linux/MacOS

## 依赖安装

```bash
# 安装所需包
pip install -r requirements.txt

# 或单独安装
pip install minimalmodbus
pip install PySide6
pip install pyserial
```

## 使用说明

### 启动程序

```bash
python penetrometer_v1_1.py
```

### 基本操作流程

1. **连接设备**
   - 选择正确的串口
   - 点击"打开串口"或"打开所有串口"
   - 确认连接状态信息

2. **切割电机控制**
   - 设置速度和距离参数
   - 选择运动模式（定距离/持续运动）
   - 监控实时位置和扭矩数据

3. **贯入电机控制**
   - 控制上升/下降动作
   - 设置运动参数
   - 监控接近开关状态

4. **数据监控**
   - 实时图表显示
   - 编码器数据记录
   - 状态信息反馈

### 注意事项

- 确保所有设备正确连接并供电
- 运行前检查串口配置
- 操作时注意安全限位
- 及时保存重要数据

## 开发指南

### 添加新功能

1. 在相应模块中实现功能逻辑
2. 更新GUI界面
3. 在主程序中连接新功能
4. 添加错误处理和日志记录

### 代码规范

- 遵循PEP 8规范
- 添加适当的注释和文档
- 实现错误处理机制
- 保持代码模块化

## 故障排除

### 常见问题

1. **串口连接失败**
   - 检查设备管理器中的串口号
   - 确认串口未被其他程序占用
   - 验证波特率设置

2. **电机响应异常**
   - 检查通信参数
   - 验证控制指令
   - 查看错误日志

3. **数据显示问题**
   - 重置数据采集
   - 检查采样率设置
   - 验证数据格式

## 维护与支持

- 定期检查和更新依赖包
- 备份重要配置和数据
- 记录系统日志以便追踪问题

## 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

## 联系方式

如有问题或建议，请通过以下方式联系：

- 项目维护者：[刘子昊]
- 邮箱：[www.617482966@foxmail.com]
- GitHub Issues：[项目地址]

## 更新日志

### v1.1
- 添加实时数据显示功能
- 优化多线程处理
- 改进错误处理机制

### v1.0
- 初始版本发布
- 基本功能实现
